void mx_normalmap(vector value, string map_space, float normal_scale, vector N, vector T, vector B, output vector result)
{
    vector n = value * 2.0 - 1.0;

    if (map_space == "tangent")
    {
        n = T * n[0] * normal_scale + B * n[1] * normal_scale + N * n[2];
    }

    result = normalize(n);
}
